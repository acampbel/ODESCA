%% Load the trucated matrices of the dhw station model

% Sample time of the discretized model
dt = 0.1;

% Constant System matrix
A_0 = [ 0.7687, 0,      0,      0.1258, 0,      0,      12.31; ...
        0.1054, 0.7687, 0,      0,      0.1258, 0,      12.31; ...
        0,      0.1054, 0.7687, 0,      0,      0.1258, 12.31; ...
        0.1161, 0,      0,      0.7867, 0.0972, 0,      0.7009; ...
        0,      0.1161, 0,      0,      0.7867, 0.0972, 0.7009; ...
        0,      0,      0.1161, 0,      0,      0.7867, 0.7009; ...
        0,      0,      0,      0,      0,      0,      0.9000];

% System matrix in depencence of d1
A_1 = [	0,  0,  0,  0,  0,  0,  1.054; ...
        0,  0,  0,  0,  0,  0,  0; ...
        0,  0,  0,  0,  0,  0,  0; ...
        0,  0,  0,  0,  0,  0,  0; ...
        0,  0,  0,  0,  0,  0,  0; ...
        0,  0,  0,  0,  0,  0,  0; ...
        0,  0,  0,  0,  0,  0,  0];

% System matrix in dependence of d3
A_3 = 1e-3*[    -0.0597,0,      0,      0.0597,     0,  0,      0; ...
                0,      -0.0597,0,      0,      0.0597, 0,      0; ...
                0,      0,      -0.0597,0,      0,      0.0597, 0; ...
                0.0551, 0,      0 ,     -972.4, 972.4,  0,      0; ...
                0,      0.0551, 0,      0,      -972.4, 972.4,  0; ...
                0,      0, 0.0551,      0,      0,      -972.4, 0; ...
                0,      0,     0,       0,      0,      0,      0];

% System matrix in dependence of d4
A_4 = [ -1.127, 0     , 0,      0.0731, 0,      0,          0; ...
        1.054,  -1.127, 0,      0,      0.0731, 0,          0; ...
        0,      1.054,  -1.127, 0,      0,      0.0731,     0; ...
        0.0675, 0,      0,      -0.0675,0,      0,          0; ...
        0,      0.0675, 0,      0,      -0.0675,0,          0; ...
        0,      0,      0.0675, 0,      0,      -0.0675,    0; ...
        0,      0,      0,      0,      0,      0,          0];

% Constant control input matrix
B_0 = [	0,	0,	0,	0,	0,	0, 0.1]';
% Disturbance input matrix in dependence of d1    
G_1 = [0.1054,	0,	0,	0,	0,	0,	0]';
% Disturbance input matrix in dependence of d2
G_2 = [0, 0, 0,	0, 0, 0.0972, 0]';
% Disturbance input matrix in dependence of d3
G_3 = [ -.0006,	-.0006,	-.0006,	-12.05,	-12.05,	-12.05, 0]';
% Disturbance input matrix in dependence of d2*d3
G_23 = [ 0,	0,	0,	0,	0, 0.9724,	0]';
% Constant output matrix
C = [0, 0, 0, 1, 0,  0,  0];
     
%% Load steady state conditions corresponding to the matrices

x_0 = [ 57.5979, 45.1957, 32.7936,	47.2064, 34.8043, 22.4021, 0.1]';
d_0 = [70, 	10, 0.1, 0.1];
u_0 = 0.1;
y_0 = C*x_0;
% Define the bounds for the disturbance inputs

d1_min = 60-d_0(1);
d1_max = 90-d_0(1);

d2_min = 5-d_0(2);
d2_max = 30-d_0(2);

d3_min = 0.05-d_0(3);
d3_max = 0.2-d_0(3);

d4_min = 0.025 - d_0(4);
d4_max = 0.5 - d_0(4);

u1_min = 0.025 - u_0;
u1_max = 0.5 - u_0;
    